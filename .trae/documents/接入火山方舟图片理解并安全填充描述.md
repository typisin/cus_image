## 目标
- 当用户在 `describer.html` 上传图片后，改为调用火山方舟图片理解接口，使用返回结果填充 `#desc`。
- API Key仅在服务端使用，前端不暴露；部署在 Vercel。

## 架构方案
- 前端：将图片转为Base64（必要时客户端压缩到最长边≤1024px），POST到自建后端 `/api/describe`。
- 后端（Vercel Serverless Function）：读取请求体的图片Base64，使用服务端环境变量中的API Key调用火山方舟 `Chat Completions v3` 图片理解能力，返回英文描述给前端。

## 后端实现（Vercel）
- 新建 `api/describe.js`（Node 18 Runtime）：
  - 读取 `req.body.imageBase64`，校验大小与类型（只接受 `image/*`）。
  - 构造请求体：
    - `model` 或 `endpoint_id`（优先使用 `endpoint_id`，均通过环境变量配置，如 `VOLC_ENDPOINT_ID` / `VOLC_MODEL`）。
    - `messages`: 包含 `system` 设定为英文描述，`user` 传入 `text` + `image_url`（`url` 支持Base64；`detail` 可设为 `low`）。
  - 请求火山方舟：`POST https://ark.cn-beijing.volces.com/api/v3/chat/completions`
    - 头：`Content-Type: application/json`，`Authorization: Bearer <从环境变量读取的API Key>`。
  - 解析返回：优先读取 `choices[0].message.content`（如为多模态数组则取其中 `text`），统一返回 `{ description }`。
  - 错误处理：超时、限流、参数错误均返回 `{ error }`，HTTP 4xx/5xx。
- 环境变量（仅服务端）：
  - `VOLC_API_KEY`：火山方舟 API Key。
  - `VOLC_ENDPOINT_ID`或`VOLC_MODEL`：模型或端点ID（建议端点ID）。
- 安全：
  - API Key只存在于服务端 `process.env`；严禁回传到前端；禁止日志打印密钥。
  - 限制请求体大小（如≤10MB），防止滥用与成本飙升。

## 前端改造（describer.html）
- 替换当前本地分析逻辑为：
  - `FileReader` 转Base64后，`fetch('/api/describe', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ imageBase64, detail:'low' }) })`。
  - 加载态：在 `#desc` 显示“Generating description…”；成功后填充英文描述；失败显示错误文案。
  - 保留复制与重置按钮行为。
- 语言一致性：系统提示与展示文案均为英文，符合项目“页面语言为英文”的规范。

## 细节与优化
- 客户端压缩：在前端用 `canvas` 将最长边压到≤1024，降低流量与Token成本。
- 提示词：系统消息如 `"You describe images in concise, natural English."`；用户文本：`"Please describe this image in 1–2 sentences."`。
- `detail`：默认 `low` 更快；若需要更细节支持改为 `high`（通过前端参数控制）。

## 测试与验证
- 本地：使用 Vercel 本地开发或直接部署预览，上传多种图片（暗/亮、人物/风景/商品），检查 `#desc` 填充与复制功能。
- 错误场景：不支持格式、超大图片、API错误与限流；确保用户看到清晰错误信息。

## 部署步骤
- 在 Vercel 项目设置中添加环境变量：`VOLC_API_KEY`、`VOLC_ENDPOINT_ID` 或 `VOLC_MODEL`。
- 推送代码后自动生成 `/api/describe` 路由；前端改造后页面直接调用该路由。

## 变更清单
- 新增：`api/describe.js`（服务端函数）。
- 修改：`describer.html` 前端JS，将本地分析改为调用后端并填充 `#desc`。

请确认上述方案，我将据此实现服务端函数与前端改造并进行本地预览验证。